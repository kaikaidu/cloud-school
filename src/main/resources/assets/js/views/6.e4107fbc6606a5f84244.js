webpackJsonp([6],{361:function(t,e,r){"use strict";function a(t){o||r(414)}Object.defineProperty(e,"__esModule",{value:!0});var n=r(392),i=r(415),o=!1,l=r(68),s=a,c=l(n.a,i.a,!1,s,null,null);c.options.__file="src\\components\\molecule\\AddCertTemplate.vue",e.default=c.exports},372:function(t,e,r){"use strict";var a=r(69),n=(r.n(a),r(42)),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t};e.a={props:["placeholder","accept","action","step","clearPercent"],data:function(){return{error:"",timer:null,percent:0,file:null,fileList:[],loadingStatus:!1}},watch:{step:function(t){0==t?this.file=null:1==t&&(this.percent=0)},clearPercent:function(t){t&&(this.percent=0,this.file=null)}},methods:{handleSuccess:function(t,e){var r=this,a=this;if(!this.file)return void(this.error="请选择要上传的文件");this.error="",this._setPos();var o=i({file:this.file},t);return this.$store.commit("loading",!0),n.a.upload({key:a.action,type:"POST",data:o}).then(function(t){return r.$store.commit("loading",!1),a._setPos(100),e||(a.percent=0),t},function(t){r.$store.commit("loading",!1),a._setPos(0,!0),r.$Modal.error({width:380,title:"温馨提示",content:t})})},_setPos:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments[1];if(this.percent=e,(100==e||r)&&this.timer)return void clearInterval(this.timer);this.timer=setInterval(function(){t.percent<=93&&(t.percent+=1)},60)},handleUpload:function(t){return this.file=t,this.$emit("preupload",t),!1}}}},379:function(t,e,r){"use strict";function a(t){o||r(380)}var n=r(372),i=r(381),o=!1,l=r(68),s=a,c=l(n.a,i.a,!1,s,null,null);c.options.__file="src\\components\\atom\\Upload.vue",e.a=c.exports},380:function(t,e){},381:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"upload-wrapper clearfix"},[t._t("title"),t._v(" "),r("Upload",{attrs:{"before-upload":t.handleUpload,accept:t.accept,action:t.action}},[r("Button",{attrs:{type:"primary",icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.placeholder))])],1),t._v(" "),t._t("tips"),t._v(" "),t.file?r("div",{staticClass:"fl showname"},[r("p",[t._v(t._s(t.file.name))])]):t._e(),t._v(" "),r("p",{directives:[{name:"show",rawName:"v-show",value:t.error,expression:"error"}],staticClass:"fl showname red"},[t._v(t._s(t.error))]),t._v(" "),t.percent>0?[r("Progress",{attrs:{percent:t.percent}})]:t._e()],2)},n=[];a._withStripped=!0;var i={render:a,staticRenderFns:n};e.a=i},392:function(t,e,r){"use strict";var a=r(379),n=r(69),i=(r.n(n),r(42)),o=r(43),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t};e.a={data:function(){return{example:'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',placeholder:"添加zip",accept:i.b.uploadType.zip,certTemplateInfo:{name:"",url:"",certTempId:""},isClearPercent:!1,rules:{name:[{required:!0,message:"请输入证书模板！",trigger:"blur"}],url:[{required:!0,message:"请上传证书zip！",trigger:"blur",validator:function(t,e,r,a,n){e&&e.indexOf("holder.png")<0?r():r(new Error("error"))}}]}}},components:{Upload:a.a},computed:l({},Object(o.c)({tempId:function(t){return t.certSetting.tempId}})),watch:{"certTemplateInfo.url":function(t){t&&(this.placeholder="重新上传")}},mounted:function(){if(this.$store.commit("tempId"),!this.tempId)return void this.$store.commit("certTemplateInfo",null);this.getTemplatenfo()},methods:{upload:function(){},preupload:function(t){var e=this;this.$refs.upload.handleSuccess({directory:"certZip"},!0).then(function(t){t&&t.data?(e.certTemplateInfo.url=t.data.url,e.certTemplateInfo.zipUrl=t.data.zipUrl,e.certTemplateInfo.htmlUrl=t.data.htmlUrl,e.$refs.formValidate.validate(function(t){})):(e.certTemplateInfo.zipUrl="",e.certTemplateInfo.htmlUrl="",e.isClearPercent=!0,e.$refs.formValidate.resetFields())},function(t){e.certTemplateInfo.zipUrl="",e.certTemplateInfo.htmlUrl="",e.isClearPercent=!0,e.$refs.formValidate.resetFields()})},getTemplatenfo:function(){var t=this;if(!this.tempId)return!1;this.$store.commit("loading",!0);var e={tempId:this.tempId};return i.a.ajax({key:"getTemplateInfo",data:e}).then(function(e){t.render(e.data),t.$store.commit("certTemplateInfo",e.data),t.$store.commit("loading",!1)},function(e){t.$store.commit("loading",!1)})},render:function(t){var e={url:"",certTempId:"",name:""};this.certTemplateInfo=t||e},add:function(){this.render(),this.placeholder="添加zip",this.$store.commit("certTemplateInfo",null),this.isClearPercent=!0,this.$refs.formValidate.resetFields(),this.$emit("add")},handleCancel:function(){this.$router.push({path:i.b.getPage("resourceTemplate")})},handleSubmit:function(t){var e=this,r=this;this.$refs[t].validate(function(t){if(t){var a={id:r.certTemplateInfo.certTempId,certTemplateName:r.certTemplateInfo.name,url:r.certTemplateInfo.url,zipUrl:r.certTemplateInfo.zipUrl,htmlUrl:r.certTemplateInfo.htmlUrl};e.$store.commit("loading",!0),i.a.ajax({key:"saveCertTemplate",type:"POST",data:a}).then(function(){r.$router.push({path:i.b.getPage("resourceTemplate")})},function(t){e.$Modal.error({title:"温馨提示",content:t}),e.$store.commit("loading",!1)})}})},getList:function(t){this.renderData(t.current)},renderData:function(t){}}}},414:function(t,e){},415:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"addcert-template-wrapper"},[r("div",{staticClass:"StuCon borderBottom"},[r("div",{staticClass:"qubaTit bjG padd10 mart10 clearfix"},[r("b",{staticClass:"fl"},[t._v("证书模板")]),t._v(" "),r("Button",{staticClass:"fr primary-red",attrs:{type:"primary",icon:"plus"},on:{click:t.add}},[t._v("新增证书模板")])],1)]),t._v(" "),r("Form",{ref:"formValidate",staticClass:"addcert-wrapper",attrs:{rules:t.rules,"label-width":120,model:t.certTemplateInfo}},[r("FormItem",{attrs:{label:"证书模板名称",prop:"name"}},[r("Input",{attrs:{type:"text",maxlength:100,clearable:"",placeholder:"请输入证书模板名称"},model:{value:t.certTemplateInfo.name,callback:function(e){t.$set(t.certTemplateInfo,"name",e)},expression:"certTemplateInfo.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:"上传证书zip",prop:"url"}},[r("Upload",{ref:"upload",attrs:{action:"uploadCertTemplate",clearPercent:t.isClearPercent,accept:t.accept,placeholder:t.placeholder},on:{preupload:t.preupload,upload:t.upload}},[r("span",{staticClass:"tips",attrs:{slot:"tips"},slot:"tips"},[t._v("重新上传将会覆盖现有文件")])]),t._v(" "),r("dl",{staticClass:"ziptips"},[r("dt",[t._v("请确保上传的zip内文件格式如下：")]),t._v(" "),r("dd",[r("p",[t._v("1.\t压缩文件格式为zip")]),t._v(" "),r("p",[t._v("2.\t必须只有一个html页面(文件为 index.htm) ")]),t._v(" "),r("p",[t._v("3.\t背景图片必须只一个 (文件为Diploma7.gif)")]),t._v(" "),r("p",[t._v("4.\t%user_name%代表学员姓名，%activity_name%代表课程名称")]),t._v(" "),r("p",[t._v("\n                5.    index.htm中需要在头部添加指定文件的编码格式，否则会出现乱码的情况，具体代码参考如下（必须包含以下代码，不能随意篡改）：\n              ")]),t._v(" "),r("p",[t._v(t._s(t.example))])])])],1),t._v(" "),r("FormItem",{staticClass:"preview-wrapper",attrs:{label:"图片预览"}},[r("div",{staticClass:"img-wrapper"},[r("img",{attrs:{src:t.certTemplateInfo.url||"../../../assets/images/holder.png"}})])]),t._v(" "),r("FormItem",{staticClass:"form-footer"},[r("Button",{on:{click:t.handleCancel}},[t._v("取 消")]),t._v(" "),r("Button",{staticClass:"primary-red",attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("保 存")])],1)],1)],1)},n=[];a._withStripped=!0;var i={render:a,staticRenderFns:n};e.a=i},68:function(t,e){t.exports=function(t,e,r,a,n,i){var o,l=t=t||{},s=typeof t.default;"object"!==s&&"function"!==s||(o=t,l=t.default);var c="function"==typeof l?l.options:l;e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),r&&(c.functional=!0),n&&(c._scopeId=n);var p;if(i?(p=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=p):a&&(p=a),p){var d=c.functional,u=d?c.render:c.beforeCreate;d?(c._injectStyles=p,c.render=function(t,e){return p.call(e),u(t,e)}):c.beforeCreate=u?[].concat(u,p):[p]}return{esModule:o,exports:l,options:c}}}});